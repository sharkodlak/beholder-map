<!DOCTYPE html>
<html>
<head>
	<title>Eye of the Beholder: Levels</title>
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<script type="module">
		import { Controls } from "./js/Controls.js";
		import { GameMap } from "./js/GameMap.js";
		import { Mapper } from "./js/Mapper.js";


		const controls = Controls.initialize();

		async function initialize() {
			const maps = {
				"level-01": "maps/level-01.txt",
				"level-02": "maps/level-02.txt",
				"level-03": "maps/level-03.txt",
				"level-04": "maps/level-04.txt",
				"level-05": "maps/level-05.txt",
				"level-06": "maps/level-06.txt",
				"level-07": "maps/level-07.txt",
				"level-08": "maps/level-08.txt",
				"level-09": "maps/level-09.txt",
				"level-10": "maps/level-10.txt",
			};
			let previousLevel;

			for (const [elementId, map] of Object.entries(maps)) {
				previousLevel = await loadAndDisplay(map, elementId, previousLevel);
			}
		}

		async function loadAndDisplay(map, elementId, previousLevel) {
			const text = await GameMap.load(map);
			const gameMap = GameMap.parse(text);
			const mapper = new Mapper(gameMap, previousLevel);

			if (previousLevel) {
				previousLevel.setNextLevel(mapper);
			}

			const DOMmap = mapper.generateMap(elementId);
			controls.initializeForMap(DOMmap);
			return mapper;
		}

		document.addEventListener("DOMContentLoaded", initialize);
	</script>
</head>
<body>
	<h2>Level 01</h2>
	<table id="level-01"></table>

	<h2>Level 02</h2>
	<table id="level-02"></table>

	<h2>Level 03</h2>
	<table id="level-03"></table>

	<h2>Level 04</h2>
	<table id="level-04"></table>

	<h2>Level 05</h2>
	<table id="level-05"></table>

	<h2>Level 06</h2>
	<table id="level-06"></table>

	<h2>Level 07</h2>
	<table id="level-07"></table>

	<h2>Level 08</h2>
	<table id="level-08"></table>

	<h2>Level 09</h2>
	<table id="level-09"></table>

	<h2>Level 10</h2>
	<table id="level-10"></table>

	<h2>Level 11</h2>
	<table id="level-11"></table>

	<h2>Level 12</h2>
	<table id="level-12"></table>
</body>

